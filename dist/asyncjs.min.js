!function(t,n){"use strict";function e(t,n){var e=t.length;return~n&&e>n&&(e=n),e}function a(t){k(function(){throw t})}function r(t){return/(^(https?:)?\/\/)|(\.js$)/.test(t)&&!/\n/.test(t)}function o(t){return t.constructor&&t.call&&t.apply}function s(t){return Array.isArray?Array.isArray(t)?t:[t]:y.concat(t)}function i(t){var n=y.push,e=y.slice.call(arguments,1);return function(){return n.apply(e,arguments),m.apply(t,e)}}function c(t,n,e){var r=this,o=null;(!r.readyState||/^c|loade/.test(r.readyState))&&(r.loadStatus||(n&&e&&(o={name:"ConnectionError",source:r.src||"Resource",evt:e,message:" fails to load.",toString:function(){return this.source+this.meassge}},a(o)),r.onload=r.onreadystatechange=null,r.loadStatus=!0,t.call(null,o)))}function l(t,n){var e=document,a=e.createElement("script"),r=e.getElementsByTagName("script"),o=r[r.length-1];if(a.async=!0,a.src=t,n){a.loadStatus=!1;var s=!0,l=i(c,a,n);a.onload=a.onreadystatechange=l,a.onerror=i(l,null,s);var u=o;u=u||(e.head||e.getElementsByTagName("head")).firstChild,u.parentNode.insertBefore(a,u)}}function u(t,n){k(function(){var e,r=o(t)?t:Function(t);try{r.call(null)}catch(s){e=s,e.source=t,a(e)}n.call(null,e)})}function f(t,n){if(!o(t)){if(r(t))return l(t,n),void 0;if(v)return t=g+encodeURIComponent(t),l(t,n),void 0}u(t,n)}function d(t,n){var e=this;e.tasks=[],e.callbacks=[],e.errors=[],e.nextTask=0,e.nextCallback=0;var a=-1;e.until=function(){return a},e.waitFor=function(t){a=t};var r=!1;e.digest=function(){return r},e.setDigest=function(t){r=t},e.add(t).whenDone(n)}function h(){var t=this;if(t.digest())return k(i(h,t)),void 0;t.setDigest(!0);for(var n,a,r=t.nextCallback;r<e(t.callbacks,t.until());r++)if(t.nextTask===t.tasks.length){if(a=t.nextCallback,n=t.callbacks[a]){if(t.nextCallback=r+1,n.call(null,t,t.nextTask-1,t.errors),!n.untilThen)continue;t.nextCallback--,t.waitFor(-1)}t.callbacks.splice(a,1)}t.setDigest(!1)}function p(t){var n=this;t&&n.errors.push(t),n.nextTask<n.tasks.length&&++n.nextTask!==n.tasks.length||h.call(n)}var g="data:application/javascript,",v=!0;navigator&&"ie"!==navigator.appName&&navigator.appVersion<8&&(v=!1);var k=function(t){setTimeout(t,50/3)},y=Array.prototype,m=Function.call;d.resolve=p,d.prototype.whenDone=function(t){var n=this;return t?n.nextTask>n.tasks.length?n:(n.callbacks.push(t),n.nextTask===n.tasks.length&&p.call(n),n):n},d.prototype.add=function(t){t=s(t);for(var n=0;n<t.length;n++)t[n]&&(this.tasks.push(t[n]),f(t[n],i(p,this)));return this},d.prototype.addSync=function(t){function n(){e.waitFor(e.nextCallback),e.add(t)}var e=this;return t?e.nextTask===e.tasks.length?(e.add(t),e):(n.untilThen=!0,e.whenDone(n),e):e},d.prototype.then=d.prototype.addSync;var x=function(t,n){return new d(t,n)};"object"==typeof exports?module.exports=x:"function"==typeof define&&define.amd?define(function(){return x}):n[t]=x}("asyncJS",this);