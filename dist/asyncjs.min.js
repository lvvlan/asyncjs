!function(t,e){"use strict";function n(t,e){var n=t.length;return~e&&n>e&&(n=e),n}function a(t){setTimeout(function(){throw t},0)}function r(t){return/(^(https?:)?\/\/)|(\.js$)/.test(t)&&!/(\n|\r)/m.test(t)}function o(t){return t.constructor&&t.call&&t.apply}function s(t){var e;return(e=Array.isArray)?e(t)?t:[t]:D.concat(t)}function i(t){function e(t){return D.concat.apply(n,t)}var n=D.slice.call(arguments,1);return function(){return F.apply(t,e(arguments))}}function l(t,e,n){var r=this,o=null;if((!r.readyState||/^c|loade/.test(r.readyState))&&!r.loadStatus){if(e&&n){var s=r.src||"Resource",i=" fails to load.";o={name:"ConnectionError",source:s,evt:n,stack:s+i,message:i,toString:function(){return this.stack}},a(o)}r.onload=r.onreadystatechange=null,r.loadStatus=!0,t.call(null,o)}}function c(t,e){var n=document,a="script",r=n.createElement(a),o=n.getElementsByTagName(a),s=o[o.length-1];if(r.async=!0,r.src=t,e){r.loadStatus=!1;var c=!0,u=i(l,r,e);r.onload=r.onreadystatechange=u,r.onerror=i(u,null,c);var f=s;f=f||document.head.firstChild,f.parentNode.insertBefore(r,f)}}function u(t,e){v(function(){var n,r=o(t)?t:Function(t);try{r.call(null)}catch(s){n=s,n.source=t,a(n)}e.call(null,n)})}function f(t,e){if(!o(t)){if(r(t))return c(t,e),void 0;if(g)return t=k+encodeURIComponent(t),c(t,e),void 0}u(t,e)}function d(t,e){var n=this;n.tasks=[],n.callbacks=[],n.errors=[],n.nextTask=0,n.nextCallback=0;var a=-1;n.until=function(){return a},n.waitFor=function(t){a=t};var r=!1;n.digest=function(){return r},n.setDigest=function(t){r=t},n.add(t).whenDone(e)}function p(){var t=this;if(t.digest())return setTimeout(i(p,t),50/3),void 0;t.setDigest(!0);for(var e,a,r=t.nextCallback;r<n(t.callbacks,t.until());r++)if(t.nextTask===t.tasks.length){if(a=t.nextCallback,e=t.callbacks[a]){if(t.nextCallback=r+1,e.call(null,t,t.nextTask-1,t.errors),!e.untilThen)continue;t.nextCallback--,t.waitFor(-1)}t.callbacks.splice(a,1)}t.setDigest(!1)}function h(t){var e=this;t&&e.errors.push(t),e.nextTask<e.tasks.length&&++e.nextTask!==e.tasks.length||p.call(e)}var v,k="data:application/javascript,",g=Boolean(1),y=window,b=y.URL||y.webkitURL,m=y.BlobBuilder||y.WebKitBlobBuilder||y.MozBlobBuilder||y.MSBlobBuilder;if(y.postMessage&&y.Worker&&b&&(y.Blob||m)){var x,w={},B=0,T="self.onmessage = function(e) {self.postMessage(e.data);};";try{x=new Blob([T],{type:"text/javascript"})}catch(S){var C=new m;C.append(T),x=C.getBlob("text/javascript")}var j=new Worker(b.createObjectURL(x));j.addEventListener("message",function(t){var e=t.data;if(e){var n=w[e]||null;n&&(n.call(null),delete w[e])}}),v=function(t){var e="asyncJS-thread-"+ ++B;w[e]=t,j.postMessage(e)}}else v=window.setImmediate?function(t){setImmediate(t)}:function(t){setTimeout(t,0)};var D=Array.prototype,F=Function.call;d.resolve=h,d.prototype.whenDone=function(t){var e=this;return t?e.nextTask>e.tasks.length?e:(e.callbacks.push(t),e.nextTask===e.tasks.length&&h.call(e),e):e},d.prototype.add=function(t){t=s(t);for(var e=0,n=i(h,this);e<t.length;e++)t[e]&&(this.tasks.push(t[e]),f(t[e],n));return this},d.prototype.addSync=function(t){function e(){n.waitFor(n.nextCallback),n.add(t)}var n=this;return t?n.nextTask===n.tasks.length?(n.add(t),n):(e.untilThen=!0,n.whenDone(e)):n},d.prototype.then=d.prototype.addSync;var M=function(t,e){return new d(t,e)};"object"==typeof exports?module.exports=M:"function"==typeof define&&define.amd?define(function(){return M}):e[t]=M}("asyncJS",this);