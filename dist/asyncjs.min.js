!function(t,e){"use strict";function n(t,e){var n=t.length;return~e&&n>e&&(n=e),n}function a(t){setTimeout(function(){throw t},0)}function r(t){return/(^(https?:)?\/\/)|(\.js$)/.test(t)&&!/(\n|\r)/m.test(t)}function o(t){return t.constructor&&t.call&&t.apply}function s(t){var e;return(e=Array.isArray)?e(t)?t:[t]:y.concat(t)}function l(t){function e(t){return y.concat.apply(n,t)}var n=y.slice.call(arguments,1);return function(){return U.apply(t,e(arguments))}}function i(t,e,n){var r=this,o=null;if((!r.readyState||/^c|loade/.test(r.readyState))&&!r.loadStatus){if(e&&n){var s=r.src||"Resource",l=" fails to load.";o={name:"ConnectionError",source:s,evt:n,stack:s+l,message:l,toString:function(){return this.stack}},a(o)}r.onload=r.onreadystatechange=null,r.loadStatus=!0,t.call(null,o)}}function c(t,e){var n="script",a=g.createElement(n),r=g.getElementsByTagName(n),o=r[r.length-1];if(a.async=!0,a.src=t,e){a.loadStatus=!1;var s=!0,c=l(i,a,e);a.onload=a.onreadystatechange=c,a.onerror=l(c,null,s);var u=o;u=u||document.head.firstChild,u.parentNode.insertBefore(a,u)}}function u(t,e){m(function(){var n,r=o(t)?t:Function(t);try{r.call(null)}catch(s){n=s,n.source=t,a(n)}e.call(null,n)})}function d(t,e){if(!o(t)){if(r(t))return c(t,e),void 0;if(b)return t=k+encodeURIComponent(t),c(t,e),void 0}u(t,e)}function f(t,e){var n=this;n.tasks=[],n.callbacks=[],n.errors=[],n.nextTask=0,n.nextCallback=0,n.until=-1,n.digest=!1,n.add(t).whenDone(e)}function p(){var t=this;if(t.digest)return setTimeout(l(p,t),50/3),void 0;t.digest=!0;for(var e,a,r=t.nextCallback;r<n(t.callbacks,t.until);r++)if(t.nextTask===t.tasks.length){if(a=t.nextCallback,e=t.callbacks[a]){if(t.nextCallback=r+1,e.call(null,t,t.nextTask-1,t.errors),!e.untilThen)continue;t.nextCallback--,t.until=-1}t.callbacks.splice(a,1)}t.digest=!1}function h(t){var e=this;t&&e.errors.push(t),e.nextTask<e.tasks.length&&++e.nextTask!==e.tasks.length||p.call(e)}function v(t,e){return new f(t,e)}var k="data:application/javascript,",g=document,y=Array.prototype,b=!0;y.indexOf||!g.all||g.addEventListener||(b=!1);var m,x=window,T=x.URL||x.webkitURL,w=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder||x.MSBlobBuilder;if(x.postMessage&&x.Worker&&T&&(x.Blob||w)){var B,S="text/javascript",C={},j=0,E="self.onmessage = function(e) {self.postMessage(e.data);};";try{B=new Blob([E],{type:S})}catch(L){var M=new w;M.append(E),B=M.getBlob(S)}var R=new Worker(T.createObjectURL(B));R.addEventListener("message",function(t){var e=t.data;if(e){var n=C[e]||null;n&&(n.call(null),delete C[e])}}),m=function(t){var e="asyncJS-thread-"+ ++j;C[e]=t,R.postMessage(e)}}else m=window.setImmediate?function(t){setImmediate(t)}:function(t){setTimeout(t,0)};var U=Function.call;f.resolve=h,f.prototype.whenDone=function(t){var e=this;return t?e.nextTask>e.tasks.length?e:(e.callbacks.push(t),e.nextTask===e.tasks.length&&h.call(e),e):e},f.prototype.add=function(t){t=s(t);for(var e=0,n=l(h,this);e<t.length;e++)t[e]&&(this.tasks.push(t[e]),d(t[e],n));return this},f.prototype.addSync=function(t){function e(){n.until=n.nextCallback,n.add(t)}var n=this;return t?n.nextTask===n.tasks.length?(n.add(t),n):(e.untilThen=!0,n.whenDone(e)):n},f.prototype.then=f.prototype.addSync,"object"==typeof exports?module.exports=v:"function"==typeof define&&define.amd?define(function(){return v}):e[t]=v}("asyncJS",this);